cscope 15 $HOME/dev/mymagicbox/basetest/testDeformer/build/cmake_build               0000017439
	@/home/user0/dev/mymagicbox/basetest/testDeformer/build/cmake/CMakeLists.txt

2 
	$cmake_mšimum_»quœed
(
VERSION
 2.6)

4 
	$£t
(
MY_PROJECT_NAME
 
‹¡DefÜm”
)

6 
	`´ojeù
(
$
{
MY_PROJECT_NAME
})

10 if(
	gUNIX
)

11 if(
	gEXISTS
 "${CMAKE_CURRENT_SOURCE_DIR}/Modules/")

13 
£t
(
CMAKE_MODULE_PATH
 "${CMAKE_CURRENT_SOURCE_DIR}/Modules/")

16 
	`mes§ge
(
SEND_ERROR
 "Failedo find module…ath: ${CMAKE_CURRENT_SOURCE_DIR}/Modules/")

17 
	$’dif
()

18 
	$’dif
(
UNIX
)

20 ià(
CMAKE_BUILD_TYPE
 
STREQUAL
 "")

21 #CMak
deçuÉs
 
to
 
Ëavšg
 
CMAKE_BUILD_TYPE
 
em±y
. 
This
 
süews
 
up


22 #difã»ÁŸtiÚ 
b‘w“n
 
debug
 
ªd
 
»Ëa£
 
buds
.

23 
	`£t
(
CMAKE_BUILD_TYPE
 "Debug"

24 
CACHE
 
STRING


26 
FORCE


28 
	$’dif
 ()

30 #£t(
CMAKE_INSTALL_PREFIX
 "${CMAKE_CURRENT_BINARY_DIR}/dist")

32 
	$fšd_·ckage
(
Maya
 
REQUIRED
)

34 #if(
NOT
 "${OGRE_VERSION_NAME}" 
STREQUAL
 "Cthugha")

35 #mes§ge(
SEND_ERROR
 "You‚eed Ogre 1.7 Cthughao buildhis.")

38 #Fšd 
Boo¡


40 
	`£t
(
HDRS


41 ../../
¤c
/
‹¡DefÜm”
.
h


44 
	`£t
(
SRCS


45 ../../
¤c
/
‹¡DefÜm”
.
ıp


46 ../../
¤c
/
¶ugš
.
ıp


49 
	`šşude_dœeùÜ›s
(

50 
$
{
MAYA_INCLUDE_DIR
}

53 
ADD_LIBRARY
Ğ
$
{
MY_PROJECT_NAME
}

54 
SHARED


55 
$
{
HDRS
}

56 
$
{
SRCS
}

61 
TARGET_LINK_LIBRARIES
Ğ
$
{
MY_PROJECT_NAME
}

62 
$
{
MAYA_Found©iÚ_LIBRARY
}

63 
$
{
MAYA_O³nMaya_LIBRARY
}

64 
$
{
MAYA_O³nMayaUI_LIBRARY
}

65 
$
{
MAYA_O³nMayaAnim_LIBRARY
}

68 
£t
(
MAYA_EXTENSION
 ".so")

70 
	$£t
(
MAYA_COMPILE_DEFINITIONS


71 
REQUIRE_IOSTREAM
 
_BOOL
 
LINUX
 
_LINUX
 
LINUX_64
)

73 
	`£t
(
MAYA_COMPILE_FLAGS


76 
	`£t
(
MAYA_LINK_FLAGS


79 
	`SET_TARGET_PROPERTIES
Ğ
$
{
MY_PROJECT_NAME
}

80 
PROPERTIES


81 
	gCOMPILE_DEFINITIONS
 "${MAYA_COMPILE_DEFINITIONS}"

82 
	gCOMPILE_FLAGS
 "${MAYA_COMPILE_FLAGS}"

83 
	gLINK_FLAGS
 "${MAYA_LINK_FLAGS}"

84 
	gPREFIX
 ""

85 
SUFFIX
 
	g$
{
	gMAYA_EXTENSION
}

87 
OUTPUT_NAME
 
	g$
{
	gMY_PROJECT_NAME
}

88 
LIBRARY_OUTPUT_DIRECTORY
 
	g$
{
	gCMAKE_CURRENT_SOURCE_DIR
}/../../
	g¶ug
-
	gšs


89 #RUNTIME_OUTPUT_DIRECTORY 
$
{
CMAKE_CURRENT_SOURCE_DIR
}/../../
¶ug
-
šs


90 #EXECUTABLE_OUTPUT_PATH 
$
{
CMAKE_CURRENT_SOURCE_DIR
}/../../
¶ug
-
šs


	@/home/user0/dev/mymagicbox/basetest/testDeformer/build/cmake/Modules/FindMaya.cmake

5 #G‘ 
·th
, 
cÚv”t
 
back¦ashes
 
as
 
$
{
ENV_$
{
v¬
}}

6 
	$IF
(
UNIX
)

7 
	`FIND_PATH
(
MAYA_BASE_DIR
 
šşude
/
maya
/
MFn
.
h


8 
PATH


9 
ENV
 
MAYA_LOCATION


11 
	$ENDIF
(
UNIX
)

15 
	`FIND_PATH
(
MAYA_INCLUDE_DIR
 
maya
/
MFn
.
h


16 
PATHS


17 
ENV
 
MAYA_LOCATION


18 
$
{
MAYA_BASE_DIR
}

19 
	gPATH_SUFFIXES


20 ../../
	gdevk™
/
	gšşude
/

21 
	gšşude
/

22 
	gDOC
 "Maya's devkit headers…ath"

24 
LIST
(
APPEND
 
MAYA_INCLUDE_DIRS
 
$
{
MAYA_INCLUDE_DIR
})

28 
FIND_PATH
(
MAYA_LIBRARY_DIR
 
libO³nMaya
.
so


29 
PATHS


30 
ENV
 
MAYA_LOCATION


31 
$
{
MAYA_BASE_DIR
}

32 
PATH_SUFFIXES


33 
lib
/

34 
DOC
 "Maya's†ibraries…ath"

40 #MESSAGE(
STATUS
 "-MAYA_INCLUDE_DIRğ" 
$
{
MAYA_INCLUDE_DIR
})

43 
	$FOREACH
(
MAYA_LIB


44 
O³nMaya


45 
O³nMayaAnim


46 
O³nMayaFX


47 
O³nMayaR’d”


48 
O³nMayaUI


49 
Image


50 
Found©iÚ


51 
IMFba£


52 
tbb


53 
cg


54 
cgGL


56 
	`FIND_LIBRARY
(
MAYA_$
{
MAYA_LIB
}_LIBRARY ${MAYA_LIB}

57 
PATHS


58 
ENV
 
MAYA_LOCATION


59 
	g$
{
	gMAYA_BASE_DIR
}

60 
PATH_SUFFIXES


61 
	gMacOS
/

62 
	glib
/

63 
	gDOC
 "Maya's ${MAYA_LIB}†ibrary…ath"

66 
LIST
(
APPEND
 
$
{
MAYA_LIBRARIES
} 
MAYA_$
{
MAYA_LIB
}
_LIBRARY
)

67 
	$ENDFOREACH
(
MAYA_LIB
)

69 #MESSAGE(
STATUS
 "-MAYA_LIBRARIESğ" 
$
{
MAYA_LIBRARIES
})

	@/home/user0/dev/mymagicbox/basetest/testDeformer/src/plugin.cpp

1 
	~<maya/MFnPlugš.h
>

2 
	~<maya/MStus.h
>

4 
	~"‹¡DefÜm”.h
"

9 
MStus
 
	$š™ŸlizePlugš
Ğ
MObjeù
 
obj
 )

11 
	`´štf
("\nplugin is†oaded -----------------------\n");

13 
MFnPlugš
 
	`¶ugš
Ğ
obj
, "yaoyu", "1.0.1", "Any" );

15 
	`CHECK_MSTATUS
(

16 
¶ugš
.
	`»gi¡”Node
(

17 
Te¡DefÜm”
::
	`cTy³Name
(),

18 
Te¡DefÜm”
::
	`cTy³Id
(),

19 
Te¡DefÜm”
::
ü—tÜ
,

20 
Te¡DefÜm”
::
š™Ÿlize
,

21 
Te¡DefÜm”
::
	`cTy³
(),

22 &
Te¡DefÜm”
::
	`cCÏssifiÿtiÚ
()

25 
MSŒšg
 
	`commªd
( "if( `window -exists createRenderNodeWindow` ) {refreshCreateRenderNodeWindow(\"" );

26 
commªd
 +ğ
Te¡DefÜm”
::
	`cCÏssifiÿtiÚ
();

27 
commªd
 += "\");}\n";

29 
	`CHECK_MSTATUS
Ğ
MGlob®
::
	`execu‹Commªd
Ğ
commªd
 ) );

31 Ğ
MS
::
kSucûss
 );

32 
	}
}

34 
MStus
 
	$unš™ŸlizePlugš
Ğ
MObjeù
 
obj
 )

36 
MFnPlugš
 
	`¶ugš
Ğ
obj
 );

38 
	`CHECK_MSTATUS
Ğ
¶ugš
.
	`d”egi¡”Node
Ğ
Te¡DefÜm”
::
	`cTy³Id
() ) );

40 
MSŒšg
 
	`commªd
( "if( `window -exists createRenderNodeWindow` ) {refreshCreateRenderNodeWindow(\"" );

41 
commªd
 +ğ
Te¡DefÜm”
::
	`cCÏssifiÿtiÚ
();

42 
commªd
 += "\");}\n";

44 
	`CHECK_MSTATUS
Ğ
MGlob®
::
	`execu‹Commªd
Ğ
commªd
 ) );

46  
MS
::
kSucûss
;

47 
	}
}

	@/home/user0/dev/mymagicbox/basetest/testDeformer/src/testDeformer.cpp

2 
	~"‹¡DefÜm”.h
"

4 
	~<cæßt
>

12 
MTy³Id
 
	gTe¡DefÜm”
::
m_id
( 0x7269b );

13 
MSŒšg
 
	gTe¡DefÜm”
::
m_şassifiÿtiÚ
("utility/general");

19 
MObjeù
 
	gTe¡DefÜm”
::
driv”_mesh
;

20 
MObjeù
 
	gTe¡DefÜm”
::
š™Ÿlized_d©a
;

21 
MObjeù
 
	gTe¡DefÜm”
::
v”t_m­
;

23 
	gTe¡DefÜm”
::
	$po¡CÚ¡ruùÜ
( )

30 
	`£tMPSaã
Ğ
Œue
 );

31 
	}
}

33 
MSŒšg
 
	gTe¡DefÜm”
::
	$cTy³Name
()

36 
	}
}

38 
MTy³Id
 
	gTe¡DefÜm”
::
	$cTy³Id
()

40  
Te¡DefÜm”
::
m_id
;

41 
	}
}

43 
	gMPxNode
::
Ty³
 
Te¡DefÜm”
::
	$cTy³
()

45  
MPxNode
::
kDefÜm”Node
;

46 
	}
}

48 cÚ¡ 
	gMSŒšg
& 
	gTe¡DefÜm”
::
	$cCÏssifiÿtiÚ
()

50  
m_şassifiÿtiÚ
;

51 
	}
}

53 
	gTe¡DefÜm”
::
	$Te¡DefÜm”
()

54 : 
	$MPxDefÜm”Node
()

56 
	}
}

58 
Te¡DefÜm”
::~
	$Te¡DefÜm”
()

60 
	}
}

62 * 
Te¡DefÜm”
::
	$ü—tÜ
()

64  
Ãw
 
	`Te¡DefÜm”
();

65 
	}
}

67 
MStus
 
	gTe¡DefÜm”
::
	$š™Ÿlize
()

69 
MFnNum”icA‰ribu‹
 
num”icA‰r
;

70 
MFnTy³dA‰ribu‹
 
pŞyMeshA‰r
;

71 
MFnEnumA‰ribu‹
 
’umA‰r
;

73 
MStus
 
¡©us
;

85 
driv”_mesh
 = 
pŞyMeshA‰r
.
	`ü—‹
Ğ"v”tSÇpIÅut", "v¢pš", 
MFnD©a
::
kMesh
, &
¡©us
 );

86 
	`CHECK_MSTATUS
Ğ
¡©us
 );

87 
	`CHECK_MSTATUS
Ğ
pŞyMeshA‰r
.
	`£tStÜabË
Ğ
çl£
 ) );

88 
	`CHECK_MSTATUS
Ğ
pŞyMeshA‰r
.
	`£tA¼ay
(
Œue
) );

89 
	`CHECK_MSTATUS
Ğ
pŞyMeshA‰r
.
	`£tCÚÃùabË
Ğ
Œue
 ) );

90 
	`CHECK_MSTATUS
Ğ
	`addA‰ribu‹
(
driv”_mesh
) );

91 
	`CHECK_MSTATUS
Ğ
	`©Œibu‹Afãùs
(
driv”_mesh
, 
ouutGeom
) );

94 
š™Ÿlized_d©a
 = 
’umA‰r
.
	`ü—‹
Ğ"š™Ÿlize", "šl", 0 , &
¡©us
 );

95 
	`CHECK_MSTATUS
Ğ
¡©us
 );

96 
	`CHECK_MSTATUS
Ğ
’umA‰r
.
	`addF›ld
( "Off", 0) );

97 
	`CHECK_MSTATUS
Ğ
’umA‰r
.
	`addF›ld
( "Re-Set Bind", 1) );

98 
	`CHECK_MSTATUS
Ğ
’umA‰r
.
	`addF›ld
( "Bound", 2) );

99 
	`CHECK_MSTATUS
Ğ
’umA‰r
.
	`£tKeyabË
(
Œue
) );

100 
	`CHECK_MSTATUS
Ğ
’umA‰r
.
	`£tStÜabË
(
Œue
) );

101 
	`CHECK_MSTATUS
Ğ
’umA‰r
.
	`£tR—dabË
(
Œue
) );

102 
	`CHECK_MSTATUS
Ğ
’umA‰r
.
	`£tWr™abË
(
Œue
) );

103 
	`CHECK_MSTATUS
Ğ
’umA‰r
.
	`£tDeçuÉ
(0) );

104 
	`CHECK_MSTATUS
Ğ
	`addA‰ribu‹
Ğ
š™Ÿlized_d©a
 ) );

105 
	`CHECK_MSTATUS
Ğ
	`©Œibu‹Afãùs
Ğ
š™Ÿlized_d©a
, 
ouutGeom
 ) );

108 
v”t_m­
 = 
num”icA‰r
.
	`ü—‹
Ğ"vtxIndexM­", "vtximp", 
MFnNum”icD©a
::
kLÚg
, 0 , &
¡©us
 );

109 
	`CHECK_MSTATUS
Ğ
¡©us
 );

110 
	`CHECK_MSTATUS
Ğ
num”icA‰r
.
	`£tKeyabË
(
çl£
) );

111 
	`CHECK_MSTATUS
Ğ
num”icA‰r
.
	`£tA¼ay
(
Œue
) );

112 
	`CHECK_MSTATUS
Ğ
num”icA‰r
.
	`£tStÜabË
(
Œue
) );

113 
	`CHECK_MSTATUS
Ğ
num”icA‰r
.
	`£tR—dabË
(
Œue
) );

114 
	`CHECK_MSTATUS
Ğ
num”icA‰r
.
	`£tWr™abË
(
Œue
) );

115 
	`CHECK_MSTATUS
Ğ
	`addA‰ribu‹
Ğ
v”t_m­
 ) );

116 
	`CHECK_MSTATUS
Ğ
	`©Œibu‹Afãùs
Ğ
v”t_m­
, 
ouutGeom
 ) );

118 
	`CHECK_MSTATUS
Ğ
MGlob®
::
	`execu‹PythÚCommªd
("impÜˆmaya.cmds; maya.cmds.makePašbË('"+
Te¡DefÜm”
::
	`cTy³Name
()+"', 'weights',‡ttrType='multiFloat')") );

120 Ğ
MS
::
kSucûss
 );

121 
	}
}

123 
MStus
 
	gTe¡DefÜm”
::
	$defÜm
(
MD©aBlock
& 
d©a
,

124 
MItGeom‘ry
& 
™”
,

125 cÚ¡ 
MM©rix
& 
loÿlToWÜldM©rix
,

126 
mIndex
)

128 
MStus
 
¡©us
;

130 
š™Ÿlized_m­pšg
 = 
d©a
.
	`šputV®ue
Ğ
š™Ÿlized_d©a
, &
¡©us
).
	`asShÜt
();

131 
	`CHECK_MSTATUS
(
¡©us
);

132 
	`__debug
(
__FUNCTION__
, "š™Ÿlized_m­pšg=%d", 
š™Ÿlized_m­pšg
);

134 ifĞ
š™Ÿlized_m­pšg
 == 1 )

136 
	`š™V”tM­pšg
(
d©a
, 
™”
, 
loÿlToWÜldM©rix
, 
mIndex
);

142 
™”
.
	`»£t
();

145 
š™Ÿlized_m­pšg
 = 
d©a
.
	`šputV®ue
Ğ
š™Ÿlized_d©a
, &
¡©us
 ).
	`asShÜt
();

146 
	`CHECK_MSTATUS
(
¡©us
);

149 ifĞ
š™Ÿlized_m­pšg
 == 2 )

151 
’v–İe
 = 
MPxDefÜm”Node
::envelope;

152 
MD©aHªdË
 
’v–İeHªdË
 = 
d©a
.
	`šputV®ue
Ğ
’v–İe
, &
¡©us
 );

153 
	`CHECK_MSTATUS
Ğ
¡©us
 );

155 
MA¼ayD©aHªdË
 
v”tM­A¼ayD©a
 = 
d©a
.
	`šputA¼ayV®ue
Ğ
v”t_m­
, &
¡©us
 );

156 
	`CHECK_MSTATUS
Ğ
¡©us
 );

158 
MA¼ayD©aHªdË
 
meshA‰rHªdË
 = 
d©a
.
	`šputA¼ayV®ue
Ğ
driv”_mesh
, &
¡©us
 );

159 
	`CHECK_MSTATUS
Ğ
¡©us
 );

161 
numMeshes
 = 
meshA‰rHªdË
.
	`–em’tCouÁ
();

162 
	`__debug
(
__FUNCTION__
, "numMeshes=%d", 
numMeshes
);

164 
	`CHECK_MSTATUS
(
meshA‰rHªdË
.
	`jumpToEËm’t
(0));

165  
couÁ
=0; couÁ < 
numMeshes
; ++count )

167 
	`__debug
(
__FUNCTION__
, "couÁ=%d", 
couÁ
);

169 
MD©aHªdË
 
cu¼’tMesh
 = 
meshA‰rHªdË
.
	`šputV®ue
(&
¡©us
);

170 
	`CHECK_MSTATUS
Ğ
¡©us
 );

173 
MObjeù
 
meshMobj
;

175 
meshMobj
 = 
cu¼’tMesh
.
	`asMesh
();

176 
	`__debugMeshInfo
(
__FUNCTION__
, 
meshMobj
);

178 
	`_defÜm_Ú_Úe_mesh
(
d©a
, 
™”
, 
loÿlToWÜldM©rix
, 
mIndex
,

179 
meshMobj
,

180 
’v–İeHªdË
, 
v”tM­A¼ayD©a
 );

183 ifĞ!
meshA‰rHªdË
.
	`Ãxt
() )

191 Ğ
MS
::
kSucûss
 );

192 
	}
}

195 
	gTe¡DefÜm”
::
	$š™V”tM­pšg
(
MD©aBlock
& 
d©a
,

196 
MItGeom‘ry
& 
™”
,

197 cÚ¡ 
MM©rix
& 
loÿlToWÜldM©rix
,

198 
mIndex
)

200 
MStus
 
¡©us
;

203 
MA¼ayD©aHªdË
 
v”tM­OutA¼ayD©a
 = 
d©a
.
	`ouutA¼ayV®ue
Ğ
v”t_m­
, &
¡©us
 );

204 
	`CHECK_MSTATUS
Ğ
¡©us
 );

206 
couÁ
 = 
™”
.
	`couÁ
();

207 
MA¼ayD©aBud”
 
	`v”tM­OutA¼ayBud”
Ğ
v”t_m­
, 
couÁ
, &
¡©us
 );

208 
	`CHECK_MSTATUS
Ğ
¡©us
 );

213 
MPoštA¼ay
 
®lPts
;

214 
®lPts
.
	`ş—r
();

216 
i
 = 0;

217  !
™”
.
	`isDÚe
(&
¡©us
) )

219 
	`CHECK_MSTATUS
Ğ
¡©us
 );

221 
MD©aHªdË
 
š™IndexD©aHnd
 = 
v”tM­OutA¼ayBud”
.
	`addEËm’t
Ğ
i
, &
¡©us
 );

222 
	`CHECK_MSTATUS
Ğ
¡©us
 );

224 
ÃgIndex
 = -1;

226 
š™IndexD©aHnd
.
	`£tIÁ
Ğ
ÃgIndex
 );

227 
š™IndexD©aHnd
.
	`£tCËª
();

229 
	`CHECK_MSTATUS
(
®lPts
.
	`­³nd
Ğ
™”
.
	`pos™iÚ
(è* 
loÿlToWÜldM©rix
 ));

230 
i
 = i+1;

231 
™”
.
	`Ãxt
();

233 
	`CHECK_MSTATUS
(
v”tM­OutA¼ayD©a
.
	`£t
Ğ
v”tM­OutA¼ayBud”
 ));

239 
MA¼ayD©aHªdË
 
meshA‰rHªdË
 = 
d©a
.
	`šputA¼ayV®ue
Ğ
driv”_mesh
, &
¡©us
 );

240 
	`CHECK_MSTATUS
Ğ
¡©us
 );

242 
numMeshes
 = 
meshA‰rHªdË
.
	`–em’tCouÁ
();

243 
	`__debug
("%s(),‚umMeshes=%d", 
__FUNCTION__
, 
numMeshes
);

245 
	`CHECK_MSTATUS
(
meshA‰rHªdË
.
	`jumpToEËm’t
(0));

246  
meshIndex
=0; meshIndex < 
numMeshes
; ++meshIndex )

248 
	`__debug
("%s(), meshIndex=%d", 
__FUNCTION__
, 
meshIndex
);

250 
MD©aHªdË
 
cu¼’tMesh
 = 
meshA‰rHªdË
.
	`šputV®ue
(&
¡©us
);

251 
	`CHECK_MSTATUS
(
¡©us
);

253 
MObjeù
 
meshMobj
 = 
cu¼’tMesh
.
	`asMesh
();

254 
	`__debug
("%s(), meshMobj.­iTy³SŒ()=%s", 
__FUNCTION__
, 
meshMobj
.
	`­iTy³SŒ
());

256 
	`__debugMeshInfo
(
__FUNCTION__
, 
meshMobj
);

258 
	`_š™V”tM­pšg_Ú_Úe_mesh
(
meshMobj
, 
v”tM­OutA¼ayBud”
, 
®lPts
);

259 
	`CHECK_MSTATUS
(
v”tM­OutA¼ayD©a
.
	`£t
Ğ
v”tM­OutA¼ayBud”
 ));

262 ifĞ!
meshA‰rHªdË
.
	`Ãxt
() )

271 
	}
}

273 
	gTe¡DefÜm”
::
	$g‘Clo£¡Pt
(cÚ¡ 
MPošt
 &
±
, cÚ¡ 
MPoštA¼ay
 &
pošts
)

275 
±Index
=0;

276 
cu¼’tDi¡ªû
 = 9e99;

277 
fu¹he¡Di¡ªûSoF¬
 = 9e99;

279 
i
 = 0; i < 
pošts
.
	`Ëngth
(); ++i)

281 
cu¼’tDi¡ªû
 = 
±
.
	`di¡ªûTo
Ğ
pošts
[
i
] );

282 if(
cu¼’tDi¡ªû
 < 
fu¹he¡Di¡ªûSoF¬
 )

284 
±Index
 = 
i
;

285 
fu¹he¡Di¡ªûSoF¬
 = 
cu¼’tDi¡ªû
;

289  
±Index
;

290 
	}
}

292 
	gTe¡DefÜm”
::
	$_defÜm_Ú_Úe_mesh
(
MD©aBlock
& 
d©a
,

293 
MItGeom‘ry
& 
™”
,

294 cÚ¡ 
MM©rix
& 
loÿlToWÜldM©rix
,

295 
mIndex
,

296 
MObjeù
 &
meshMobj
,

297 cÚ¡ 
MD©aHªdË
 &
’v–İeHªdË
, 
MA¼ayD©aHªdË
 &
v”tM­A¼ayD©a
)

299 
MStus
 
¡©us
;

301 
’v
 = 
’v–İeHªdË
.
	`asFlßt
();

303 
MItMeshV”‹x
 
	`v”tI‹r
Ğ
meshMobj
, &
¡©us
 );

304 
	`CHECK_MSTATUS
Ğ
¡©us
 );

306  !
™”
.
	`isDÚe
(&
¡©us
) )

308 
	`CHECK_MSTATUS
Ğ
¡©us
 );

310 
weight
 = 
	`weightV®ue
Ğ
d©a
, 
mIndex
, 
™”
.
	`šdex
() );

311 
ww
 = 
weight
 * 
’v
;

313 iàĞ
	`çbs
(
ww
è> 
FLT_EPSILON
 )

315 
	`__debug
("%s(), vertMapArrayData.elementCount()=%d, iter.index()=%d",

316 
__FUNCTION__
, 
v”tM­A¼ayD©a
.
	`–em’tCouÁ
(), 
™”
.
	`šdex
());

318 
	`CHECK_MSTATUS
(
v”tM­A¼ayD©a
.
	`jumpToEËm’t
(
™”
.
	`šdex
()));

320 
šdex_m­³d
 = 
v”tM­A¼ayD©a
.
	`šputV®ue
(&
¡©us
).
	`asIÁ
();

321 
	`CHECK_MSTATUS
Ğ
¡©us
 );

323 ifĞ
šdex_m­³d
 >= 0 )

325 
´evIÁ
;

326 
	`CHECK_MSTATUS
Ğ
v”tI‹r
.
	`£tIndex
(
šdex_m­³d
, 
´evIÁ
) );

328 
MPošt
 
m­³dPt
 = 
v”tI‹r
.
	`pos™iÚ
Ğ
MS·û
::
kWÜld
, &
¡©us
 );

329 
	`CHECK_MSTATUS
Ğ
¡©us
 );

331 
MPošt
 
™”Pt
 = 
™”
.
	`pos™iÚ
(
MS·û
::
kObjeù
, &
¡©us
è* 
loÿlToWÜldM©rix
;

332 
	`CHECK_MSTATUS
Ğ
¡©us
 );

334 
MPošt
 
±
 = 
™”Pt
 + ((
m­³dPt
 - i‹rPtè* 
ww
 );

335 
±
 =…ˆ* 
loÿlToWÜldM©rix
.
	`šv”£
();

336 
	`CHECK_MSTATUS
(
™”
.
	`£tPos™iÚ
Ğ
±
 ));

339 
	`CHECK_MSTATUS
(
™”
.
	`Ãxt
());

341 
	}
}

344 
	gTe¡DefÜm”
::
	$_š™V”tM­pšg_Ú_Úe_mesh
Ğ
MObjeù
 &
meshMobj
, 
MA¼ayD©aBud”
 &
v”tM­OutA¼ayBud”
, cÚ¡ 
MPoštA¼ay
& 
®lPts
)

346 
MStus
 
¡©us
;

349 
MItMeshV”‹x
 
	`v”tI‹r
Ğ
meshMobj
, &
¡©us
 );

350 
	`CHECK_MSTATUS
(
¡©us
);

351 
	`CHECK_MSTATUS
(
v”tI‹r
.
	`»£t
());

355  !
v”tI‹r
.
	`isDÚe
(&
¡©us
) )

357 
	`CHECK_MSTATUS
(
¡©us
);

360 
MPošt
 
driv”_±
;

361 
driv”_±
 = 
v”tI‹r
.
	`pos™iÚ
Ğ
MS·û
::
kWÜld
, &
¡©us
 );

362 
	`CHECK_MSTATUS
(
¡©us
);

365 
şo£¡_±_šdex
 = 
	`g‘Clo£¡Pt
Ğ
driv”_±
, 
®lPts
 );

368 
MD©aHªdË
 
¢­D©aHnd
 = 
v”tM­OutA¼ayBud”
.
	`addEËm’t
Ğ
şo£¡_±_šdex
, &
¡©us
 );

369 
	`CHECK_MSTATUS
Ğ
¡©us
 );

370 
¢­D©aHnd
.
	`£tIÁ
Ğ
v”tI‹r
.
	`šdex
() );

371 
¢­D©aHnd
.
	`£tCËª
();

373 
	`CHECK_MSTATUS
(
v”tI‹r
.
	`Ãxt
());

375 
	}
}

377 
	gTe¡DefÜm”
::
	$__debug
(cÚ¡ * 
fÜm©
, ...) const

379 
va_li¡
 
¬gs
;

380 
msg
[ 1024 ];

382 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

384 
	`v¢´štf
(
msg
, 1024, 
fÜm©
, 
¬gs
);

386 
	`årštf
(
¡dout
, "Debug> %s\n", 
msg
);

388 
	`va_’d
(
¬gs
);

389 
	}
}

391 
	gTe¡DefÜm”
::
	$__debugMeshInfo
(cÚ¡ * 
msg
, 
MObjeù
 &
meshMobj
)const

393 #ifdeà
_DEBUG


395 
MStus
 
¡©us
;

397 
MFnMesh
 
	`âMesh
(
meshMobj
, &
¡©us
);

398 
	`CHECK_MSTATUS
(
¡©us
);

400 
	`__debug
("%s(), fnMesh.fuÎP©hName=%s", 
msg
, 
âMesh
.
	`fuÎP©hName
().
	`asCh¬
());

401 
	`__debug
("%s(), fnMesh.Çme=%s", 
msg
, 
âMesh
.
	`Çme
().
	`asCh¬
());

403 
MDagP©h
 
·th
; 
	`CHECK_MSTATUS
(
âMesh
.
	`g‘P©h
(path));

404 
	`__debug
("%s(),…©h=%s", 
msg
, 
·th
.
	`fuÎP©hName
().
	`asCh¬
());

406 
MDagP©h
 
dag·th
 = 
âMesh
.
	`dagP©h
(&
¡©us
); 
	`CHECK_MSTATUS
(status);

407 
	`__debug
("%s(), dag·th=%s", 
msg
, 
dag·th
.
	`fuÎP©hName
().
	`asCh¬
());

409 
MFnD•’d’cyNode
 
	`âDNode
(
meshMobj
, &
¡©us
); 
	`CHECK_MSTATUS
(status);

410 
	`__debug
("%s(),‚ame=%s", 
msg
, 
âDNode
.
	`Çme
().
	`asCh¬
());

412 
MFnDagNode
 
	`âDagNode
(
meshMobj
, &
¡©us
);

413 
	`CHECK_MSTATUS
(
¡©us
);

415 
MDagP©h
 
·th2
; 
	`CHECK_MSTATUS
(
âDagNode
.
	`g‘P©h
(path2));

416 
	`__debug
("%s(),…©h2=%s", 
msg
, 
·th2
.
	`fuÎP©hName
().
	`asCh¬
());

418 
MDagP©h
 
dag·th2
 = 
âDagNode
.
	`dagP©h
(&
¡©us
); 
	`CHECK_MSTATUS
(status);

419 
	`__debug
("%s(), dag·th2=%s", 
msg
, 
dag·th2
.
	`fuÎP©hName
().
	`asCh¬
());

421 
	}
}

	@/home/user0/dev/mymagicbox/basetest/testDeformer/src/testDeformer.h

23 #´agm¨
Úû


25 
	~<maya/MIOSŒ—m.h
>

26 
	~<maya/MPxDefÜm”Node.h
>

27 
	~<maya/MSŒšg.h
>

28 
	~<maya/MTy³Id.h
>

29 
	~<maya/MPlug.h
>

30 
	~<maya/MD©aBlock.h
>

31 
	~<maya/MD©aHªdË.h
>

32 
	~<maya/MA¼ayD©aHªdË.h
>

33 
	~<maya/MFnNum”icA‰ribu‹.h
>

34 
	~<maya/MFnTy³dA‰ribu‹.h
>

35 
	~<maya/MFnEnumA‰ribu‹.h
>

36 
	~<maya/MFlßtVeùÜ.h
>

37 
	~<maya/MGlob®.h
>

38 
	~<maya/MPoštA¼ay.h
>

39 
	~<maya/MItMeshV”‹x.h
>

40 
	~<maya/MItGeom‘ry.h
>

41 
	~<maya/MM©rix.h
>

42 
	~<maya/MA¼ayD©aBud”.h
>

43 
	~<maya/MFnMesh.h
>

44 
	~<maya/MDagP©h.h
>

45 
	~<maya/MFnD•’d’cyNode.h
>

46 
	~<maya/MFnDagNode.h
>

55 şas 
	cTe¡DefÜm”
 : 
public
 
MPxDefÜm”Node


57 
public
:

58 
Te¡DefÜm”
();

59 
	mvœtu®
 ~
Te¡DefÜm”
();

61 * 
ü—tÜ
();

63 
MStus
 
š™Ÿlize
();

78 
vœtu®
 
po¡CÚ¡ruùÜ
();

79 
vœtu®
 
MStus
 
defÜm
(
MD©aBlock
& 
d©a
,

80 
MItGeom‘ry
& 
™”
,

81 cÚ¡ 
MM©rix
& 
loÿlToWÜldM©rix
,

82 
mIndex
);

84 
MSŒšg
 
cTy³Name
();

85 
MTy³Id
 
cTy³Id
();

86 
	mMPxNode
::
Ty³
 
cTy³
();

87 cÚ¡ 
	mMSŒšg
& 
cCÏssifiÿtiÚ
();

89 
	m´iv©e
:

90 
š™V”tM­pšg
(
MD©aBlock
& 
d©a
,

91 
MItGeom‘ry
& 
™”
,

92 cÚ¡ 
MM©rix
& 
loÿlToWÜldM©rix
,

93 
mIndex
);

94 
g‘Clo£¡Pt
(cÚ¡ 
MPošt
 &
±
, cÚ¡ 
MPoštA¼ay
 &
pošts
);

96 
_defÜm_Ú_Úe_mesh
(
MD©aBlock
& 
d©a
,

97 
MItGeom‘ry
& 
™”
,

98 cÚ¡ 
MM©rix
& 
loÿlToWÜldM©rix
,

99 
mIndex
,

100 
MObjeù
 &
meshMobj
,

101 cÚ¡ 
MD©aHªdË
 &
’v–İeHªdË
, 
MA¼ayD©aHªdË
 &
v”tM­A¼ayD©a
);

103 
_š™V”tM­pšg_Ú_Úe_mesh
Ğ
MObjeù
 &
meshMobj
, 
MA¼ayD©aBud”
 &
v”tM­OutA¼ayBud”
, cÚ¡ 
MPoštA¼ay
& 
®lPts


105 
	$__debug
(cÚ¡ * 
fÜm©
, ...) const;

106 
	$__debugMeshInfo
(cÚ¡ * 
msg
, 
MObjeù
 &
objeù
)const;

108 
´Ùeùed
:

109 
MTy³Id
 
m_id
;

110 
MSŒšg
 
m_şassifiÿtiÚ
;

112 
MObjeù
 
driv”_mesh
;

113 
MObjeù
 
š™Ÿlized_d©a
;

114 
MObjeù
 
v”t_m­
;

	@
1
.
1
/usr/include
5
362
/home/user0/dev/mymagicbox/basetest/testDeformer/build/cmake/CMakeLists.txt
/home/user0/dev/mymagicbox/basetest/testDeformer/build/cmake/Modules/FindMaya.cmake
/home/user0/dev/mymagicbox/basetest/testDeformer/src/plugin.cpp
/home/user0/dev/mymagicbox/basetest/testDeformer/src/testDeformer.cpp
/home/user0/dev/mymagicbox/basetest/testDeformer/src/testDeformer.h
